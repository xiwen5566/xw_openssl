<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>crypto/bn/bn_lcl.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('bn__lcl_8h_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">bn_lcl.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="bn__lcl_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright 1995-2016 The OpenSSL Project Authors. All Rights Reserved.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Licensed under the OpenSSL license (the &quot;License&quot;).  You may not use</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * this file except in compliance with the License.  You can obtain a copy</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * in the file LICENSE in the source distribution or at</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * https://www.openssl.org/source/license.html</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#ifndef HEADER_BN_LCL_H</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor"># define HEADER_BN_LCL_H</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * The EDK2 build doesn&#39;t use bn_conf.h; it sets THIRTY_TWO_BIT or</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * SIXTY_FOUR_BIT in its own environment since it doesn&#39;t re-run our</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Configure script and needs to support both 32-bit and 64-bit.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor"># include &lt;openssl/opensslconf.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor"># if !defined(OPENSSL_SYS_UEFI)</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#  include &quot;internal/bn_conf.h&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor"># include &quot;<a class="code" href="bn__int_8h.html">internal/bn_int.h</a>&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#ifdef  __cplusplus</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> * These preprocessor symbols control various aspects of the bignum headers</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> * and library code. They&#39;re not defined by any &quot;normal&quot; configuration, as</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> * they are intended for development and testing purposes. NB: defining all</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"> * three can be useful for debugging application code as well as openssl</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * itself. BN_DEBUG - turn on various debugging alterations to the bignum</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * code BN_DEBUG_RAND - uses random poisoning of unused words to trip up</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * mismanagement of bignum internals. You must also define BN_DEBUG.</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/* #define BN_DEBUG */</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/* #define BN_DEBUG_RAND */</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor"># ifndef OPENSSL_SMALL_FOOTPRINT</span></div><div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a3144247d397b5c9ad1e68163abcbb21b">   43</a></span>&#160;<span class="preprocessor">#  define BN_MUL_COMBA</span></div><div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a8f531fa54cb406b8cc3a507981fb4359">   44</a></span>&#160;<span class="preprocessor">#  define BN_SQR_COMBA</span></div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a31bf2bca0235196c9c3bc24b18d353ef">   45</a></span>&#160;<span class="preprocessor">#  define BN_RECURSION</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * This next option uses the C libraries (2 word)/(1 word) function. If it is</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * not defined, I use my C version (which is slower). The reason for this</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * flag is that when the particular C compiler library routine is used, and</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * the library is linked with a different compiler, the library is missing.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * This mostly happens when the library is built with gcc and then linked</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * using normal cc.  This would be a common occurrence because gcc normally</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * produces code that is 2 times faster than system compilers for the big</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * number stuff. For machines with only one compiler (or shared libraries),</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> * this should be on.  Again this in only really a problem on machines using</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> * &quot;long long&#39;s&quot;, are 32bit, and are not using my assembler code.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor"># if defined(OPENSSL_SYS_MSDOS) || defined(OPENSSL_SYS_WINDOWS) || \</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">    defined(OPENSSL_SYS_WIN32) || defined(linux)</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#  define BN_DIV2W</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> * 64-bit processor with LP64 ABI</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"># ifdef SIXTY_FOUR_BIT_LONG</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#  define BN_ULLONG       unsigned long long</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#  define BN_BITS4        32</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#  define BN_MASK2        (0xffffffffffffffffL)</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#  define BN_MASK2l       (0xffffffffL)</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#  define BN_MASK2h       (0xffffffff00000000L)</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#  define BN_MASK2h1      (0xffffffff80000000L)</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#  define BN_DEC_CONV     (10000000000000000000UL)</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#  define BN_DEC_NUM      19</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT1     &quot;%lu&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT2     &quot;%019lu&quot;</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * 64-bit processor other than LP64 ABI</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor"># ifdef SIXTY_FOUR_BIT</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="preprocessor">#  undef BN_LLONG</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="preprocessor">#  undef BN_ULLONG</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">#  define BN_BITS4        32</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#  define BN_MASK2        (0xffffffffffffffffLL)</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#  define BN_MASK2l       (0xffffffffL)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">#  define BN_MASK2h       (0xffffffff00000000LL)</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">#  define BN_MASK2h1      (0xffffffff80000000LL)</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">#  define BN_DEC_CONV     (10000000000000000000ULL)</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#  define BN_DEC_NUM      19</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT1     &quot;%llu&quot;</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT2     &quot;%019llu&quot;</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor"># ifdef THIRTY_TWO_BIT</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">#  ifdef BN_LLONG</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#   if defined(_WIN32) &amp;&amp; !defined(__GNUC__)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#    define BN_ULLONG     unsigned __int64</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor">#   else</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#    define BN_ULLONG     unsigned long long</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#  define BN_BITS4        16</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">#  define BN_MASK2        (0xffffffffL)</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#  define BN_MASK2l       (0xffff)</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#  define BN_MASK2h1      (0xffff8000L)</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">#  define BN_MASK2h       (0xffff0000L)</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#  define BN_DEC_CONV     (1000000000L)</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#  define BN_DEC_NUM      9</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT1     &quot;%u&quot;</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#  define BN_DEC_FMT2     &quot;%09u&quot;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">/*-</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * Bignum consistency macros</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> * There is one &quot;API&quot; macro, bn_fix_top(), for stripping leading zeroes from</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> * bignum data after direct manipulations on the data. There is also an</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> * &quot;internal&quot; macro, bn_check_top(), for verifying that there are no leading</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> * zeroes. Unfortunately, some auditing is required due to the fact that</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> * bn_fix_top() has become an overabused duct-tape because bignum data is</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> * occasionally passed around in an inconsistent state. So the following</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * changes have been made to sort this out;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> * - bn_fix_top()s implementation has been moved to bn_correct_top()</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> * - if BN_DEBUG isn&#39;t defined, bn_fix_top() maps to bn_correct_top(), and</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> *   bn_check_top() is as before.</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * - if BN_DEBUG *is* defined;</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> *   - bn_check_top() tries to pollute unused words even if the bignum &#39;top&#39; is</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> *     consistent. (ed: only if BN_DEBUG_RAND is defined)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> *   - bn_fix_top() maps to bn_check_top() rather than &quot;fixing&quot; anything.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> * The idea is to have debug builds flag up inconsistent bignums when they</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> * occur. If that occurs in a bn_fix_top(), we examine the code in question; if</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * the use of bn_fix_top() was appropriate (ie. it follows directly after code</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> * that manipulates the bignum) it is converted to bn_correct_top(), and if it</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> * was not appropriate, we convert it permanently to bn_check_top() and track</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * down the cause of the bug. Eventually, no internal code should be using the</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> * bn_fix_top() macro. External applications and libraries should try this with</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> * their own code too, both in terms of building against the openssl headers</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> * with BN_DEBUG defined *and* linking with a version of OpenSSL built with it</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * defined. This not only improves external code, it provides more test</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> * coverage for openssl&#39;s own code.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor"># ifdef BN_DEBUG</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#  ifdef BN_DEBUG_RAND</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">/* To avoid &quot;make update&quot; cvs wars due to BN_DEBUG, use some tricks */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">#   ifndef RAND_bytes</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="keywordtype">int</span> <a class="code" href="rand__lib_8c.html#a66d27b98b0edadbed6594350d5c023e4">RAND_bytes</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">#    define BN_DEBUG_TRIX</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="preprocessor">#   define bn_pollute(a) \</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">        do { \</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">            const BIGNUM *_bnum1 = (a); \</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="preprocessor">            if (_bnum1-&gt;top &lt; _bnum1-&gt;dmax) { \</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="preprocessor">                unsigned char _tmp_char; \</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="preprocessor">                </span><span class="comment">/* We cast away const without the compiler knowing, any \</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">                 * *genuinely* constant variables that aren&#39;t mutable \</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">                 * wouldn&#39;t be constructed with top!=dmax. */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">                BN_ULONG *_not_const; \</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="preprocessor">                memcpy(&amp;_not_const, &amp;_bnum1-&gt;d, sizeof(_not_const)); \</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="preprocessor">                RAND_bytes(&amp;_tmp_char, 1); </span><span class="comment">/* Debug only - safe to ignore error return */</span><span class="preprocessor">\</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="preprocessor">                memset(_not_const + _bnum1-&gt;top, _tmp_char, \</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="preprocessor">                       sizeof(*_not_const) * (_bnum1-&gt;dmax - _bnum1-&gt;top)); \</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="preprocessor">            } \</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">        } while(0)</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#   ifdef BN_DEBUG_TRIX</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#    undef RAND_bytes</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#  else</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#   define bn_pollute(a)</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#  endif</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#  define bn_check_top(a) \</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="preprocessor">        do { \</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">                const BIGNUM *_bnum2 = (a); \</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">                if (_bnum2 != NULL) { \</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">                        OPENSSL_assert(((_bnum2-&gt;top == 0) &amp;&amp; !_bnum2-&gt;neg) || \</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="preprocessor">                                (_bnum2-&gt;top &amp;&amp; (_bnum2-&gt;d[_bnum2-&gt;top - 1] != 0))); \</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">                        bn_pollute(_bnum2); \</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">                } \</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">        } while(0)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#  define bn_fix_top(a)           bn_check_top(a)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#  define bn_check_size(bn, bits) bn_wcheck_size(bn, ((bits+BN_BITS2-1))/BN_BITS2)</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#  define bn_wcheck_size(bn, words) \</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">        do { \</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">                const BIGNUM *_bnum2 = (bn); \</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">                OPENSSL_assert((words) &lt;= (_bnum2)-&gt;dmax &amp;&amp; \</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">                        (words) &gt;= (_bnum2)-&gt;top); \</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">                </span><span class="comment">/* avoid unused variable warning with NDEBUG */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">                (void)(_bnum2); \</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">        } while(0)</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor"># else                          </span><span class="comment">/* !BN_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a5aa5550d1ddd9ff4cc5f539a1fc5db45">  200</a></span>&#160;<span class="preprocessor">#  define bn_pollute(a)</span></div><div class="line"><a name="l00201"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a95257c8ba175f77c58a26d83369efc96">  201</a></span>&#160;<span class="preprocessor">#  define bn_check_top(a)</span></div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a14a7d310d6f4210e1de5c7e1c8caf057">  202</a></span>&#160;<span class="preprocessor">#  define bn_fix_top(a)           bn_correct_top(a)</span></div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aebc2e9621508cbbd4d54f963c56c352f">  203</a></span>&#160;<span class="preprocessor">#  define bn_check_size(bn, bits)</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ac3acd61bd9d36efc399d763ebb77aeb2">  204</a></span>&#160;<span class="preprocessor">#  define bn_wcheck_size(bn, words)</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#ac7390b2c1f95cf296aaa80068bbea55c">bn_mul_add_words</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keywordtype">int</span> num,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                          BN_ULONG w);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#ab53b589b38d0dba70e7af60e433a674d">bn_mul_words</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keywordtype">int</span> num, BN_ULONG w);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a5099f504342e8405343b2f34a7e2042b">bn_sqr_words</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#a11b748f408b37078e940634d00c0acdf">bn_div_words</a>(BN_ULONG <a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>, BN_ULONG l, BN_ULONG d);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keyword">const</span> BN_ULONG *<a class="code" href="openssl_2conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                      <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keyword">const</span> BN_ULONG *<a class="code" href="openssl_2conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                      <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structbignum__st.html">  218</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structbignum__st.html">bignum_st</a> {</div><div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="structbignum__st.html#a4422fb07afc9fd462635e42d26051c49">  219</a></span>&#160;    BN_ULONG *<a class="code" href="structbignum__st.html#a4422fb07afc9fd462635e42d26051c49">d</a>;                <span class="comment">/* Pointer to an array of &#39;BN_BITS2&#39; bit</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">                                 * chunks. */</span></div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="structbignum__st.html#af93f4f37fc2ad9c37af4a715423b110c">  221</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbignum__st.html#af93f4f37fc2ad9c37af4a715423b110c">top</a>;                    <span class="comment">/* Index of last used d +1. */</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">/* The next are internal book keeping for bn_expand. */</span></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="structbignum__st.html#a3957bf07e2d7a09bae62601592079d3d">  223</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbignum__st.html#a3957bf07e2d7a09bae62601592079d3d">dmax</a>;                   <span class="comment">/* Size of the d array. */</span></div><div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="structbignum__st.html#a186b6342d483ea691785eb9a6d88605b">  224</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbignum__st.html#a186b6342d483ea691785eb9a6d88605b">neg</a>;                    <span class="comment">/* one if the number is negative */</span></div><div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="structbignum__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">  225</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbignum__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;};</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/* Used for montgomery multiplication */</span></div><div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html">  229</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structbn__mont__ctx__st.html">bn_mont_ctx_st</a> {</div><div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#adefccf195553a86b78e30f79147bb619">  230</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbn__mont__ctx__st.html#adefccf195553a86b78e30f79147bb619">ri</a>;                     <span class="comment">/* number of bits in R */</span></div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#ad99ae4970cb39992572fc82ab7990fde">  231</a></span>&#160;    BIGNUM <a class="code" href="structbn__mont__ctx__st.html#ad99ae4970cb39992572fc82ab7990fde">RR</a>;                  <span class="comment">/* used to convert to montgomery form */</span></div><div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">  232</a></span>&#160;    BIGNUM <a class="code" href="structbn__mont__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">N</a>;                   <span class="comment">/* The modulus */</span></div><div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#a40f495d7fe7da52b68a829c6de297bc8">  233</a></span>&#160;    BIGNUM <a class="code" href="structbn__mont__ctx__st.html#a40f495d7fe7da52b68a829c6de297bc8">Ni</a>;                  <span class="comment">/* R*(1/R mod N) - N*Ni = 1 (Ni is only</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                                 * stored for bignum algorithm) */</span></div><div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#a45385d48db38ec52be2b0897a1f6a435">  235</a></span>&#160;    BN_ULONG n0[2];             <span class="comment">/* least significant word(s) of Ni; (type</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">                                 * changed with 0.9.9, was &quot;BN_ULONG n0;&quot;</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">                                 * before) */</span></div><div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="structbn__mont__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">  238</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbn__mont__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;};</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> * Used for reciprocal division/mod functions It cannot be shared between</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> * threads</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00245"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html">  245</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structbn__recp__ctx__st.html">bn_recp_ctx_st</a> {</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">  246</a></span>&#160;    BIGNUM <a class="code" href="structbn__recp__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">N</a>;                   <span class="comment">/* the divisor */</span></div><div class="line"><a name="l00247"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html#aa48ed99405e961fd992d716f0cd966cf">  247</a></span>&#160;    BIGNUM <a class="code" href="structbn__recp__ctx__st.html#aa48ed99405e961fd992d716f0cd966cf">Nr</a>;                  <span class="comment">/* the reciprocal */</span></div><div class="line"><a name="l00248"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html#a3248b66d0aee4e118d186124a596f522">  248</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbn__recp__ctx__st.html#a3248b66d0aee4e118d186124a596f522">num_bits</a>;</div><div class="line"><a name="l00249"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html#afd8d704fff636cf0234e92c1eade927c">  249</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbn__recp__ctx__st.html#afd8d704fff636cf0234e92c1eade927c">shift</a>;</div><div class="line"><a name="l00250"></a><span class="lineno"><a class="line" href="structbn__recp__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">  250</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structbn__recp__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">flags</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;};</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">/* Used for slow &quot;generation&quot; functions. */</span></div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="structbn__gencb__st.html">  254</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structbn__gencb__st.html">bn_gencb_st</a> {</div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structbn__gencb__st.html#aee119b00fe81f0baf8518dae456c9dc9">  255</a></span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structbn__gencb__st.html#aee119b00fe81f0baf8518dae456c9dc9">ver</a>;           <span class="comment">/* To handle binary (in)compatibility */</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="structbn__gencb__st.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">  256</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="structbn__gencb__st.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>;                  <span class="comment">/* callback-specific data */</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keyword">union </span>{</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="comment">/* if (ver==1) - handles old style callbacks */</span></div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="structbn__gencb__st.html#aa539df7ce1350e22f8e6d80851ee9880">  259</a></span>&#160;        void (*cb_1) (int, int, <span class="keywordtype">void</span> *);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="comment">/* if (ver==2) - new callback style */</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="structbn__gencb__st.html#afa25214ca7d6721c7c6f449d564adf73">  261</a></span>&#160;        int (*cb_2) (int, int, BN_GENCB *);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    } <a class="code" href="bn_8h.html#a3440f8540faaec9c34da16295933680d">cb</a>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;};</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">/*-</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * BN_window_bits_for_exponent_size -- macro for sliding window mod_exp functions</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> * For window size &#39;w&#39; (w &gt;= 2) and a random &#39;b&#39; bits exponent,</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> * the number of multiplications is a constant plus on average</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> *    2^(w-1) + (b-w)/(w+1);</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> * here  2^(w-1)  is for precomputing the table (we actually need</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> * entries only for windows that have the lowest bit set), and</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> * (b-w)/(w+1)  is an approximation for the expected number of</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> * w-bit windows, not counting the first one.</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> * Thus we should use</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment"> *    w &gt;= 6  if        b &gt; 671</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"> *     w = 5  if  671 &gt; b &gt; 239</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment"> *     w = 4  if  239 &gt; b &gt;  79</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> *     w = 3  if   79 &gt; b &gt;  23</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> *    w &lt;= 2  if   23 &gt; b</span></div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> * (with draws in between).  Very small exponents are often selected</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> * with low Hamming weight, so we use  w = 1  for b &lt;= 23.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aa960de98937dbcc97931def7af45e608">  290</a></span>&#160;<span class="preprocessor"># define BN_window_bits_for_exponent_size(b) \</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="preprocessor">                ((b) &gt; 671 ? 6 : \</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="preprocessor">                 (b) &gt; 239 ? 5 : \</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="preprocessor">                 (b) &gt;  79 ? 4 : \</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="preprocessor">                 (b) &gt;  23 ? 3 : 1)</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> * BN_mod_exp_mont_conttime is based on the assumption that the L1 data cache</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> * line width of the target processor is at least the following value.</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00300"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a29607830d47d3a901f79b940bee73fbc">  300</a></span>&#160;<span class="preprocessor"># define MOD_EXP_CTIME_MIN_CACHE_LINE_WIDTH      ( 64 )</span></div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a726a5a0accf869e3d891e375ea383d2b">  301</a></span>&#160;<span class="preprocessor"># define MOD_EXP_CTIME_MIN_CACHE_LINE_MASK       (MOD_EXP_CTIME_MIN_CACHE_LINE_WIDTH - 1)</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * Window sizes optimized for fixed window size modular exponentiation</span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> * algorithm (BN_mod_exp_mont_consttime). To achieve the security goals of</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> * BN_mode_exp_mont_consttime, the maximum size of the window must not exceed</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * log_2(MOD_EXP_CTIME_MIN_CACHE_LINE_WIDTH). Window size thresholds are</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> * defined for cache line sizes of 32 and 64, cache line sizes where</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> * log_2(32)=5 and log_2(64)=6 respectively. A window size of 7 should only be</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * used on processors that have a 128 byte or greater cache line size.</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor"># if MOD_EXP_CTIME_MIN_CACHE_LINE_WIDTH == 64</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aee2cc22cc63679eb7b0d04d3ac3a5d31">  314</a></span>&#160;<span class="preprocessor">#  define BN_window_bits_for_ctime_exponent_size(b) \</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">                ((b) &gt; 937 ? 6 : \</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">                 (b) &gt; 306 ? 5 : \</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">                 (b) &gt;  89 ? 4 : \</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">                 (b) &gt;  22 ? 3 : 1)</span></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a8cba1e5f9168689d2142ccbd7f4d36e0">  319</a></span>&#160;<span class="preprocessor">#  define BN_MAX_WINDOW_BITS_FOR_CTIME_EXPONENT_SIZE    (6)</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="preprocessor"># elif MOD_EXP_CTIME_MIN_CACHE_LINE_WIDTH == 32</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="preprocessor">#  define BN_window_bits_for_ctime_exponent_size(b) \</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="preprocessor">                ((b) &gt; 306 ? 5 : \</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="preprocessor">                 (b) &gt;  89 ? 4 : \</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="preprocessor">                 (b) &gt;  22 ? 3 : 1)</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="preprocessor">#  define BN_MAX_WINDOW_BITS_FOR_CTIME_EXPONENT_SIZE    (5)</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">/* Pentium pro 16,16,16,32,64 */</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/* Alpha       16,16,16,16.64 */</span></div><div class="line"><a name="l00333"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a7c50e84c467aa5543b1981a373b1e7ba">  333</a></span>&#160;<span class="preprocessor"># define BN_MULL_SIZE_NORMAL                     (16)</span><span class="comment">/* 32 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aa47fdcb7324b0be0ab56467cf39b8d16">  334</a></span>&#160;<span class="preprocessor"># define BN_MUL_RECURSIVE_SIZE_NORMAL            (16)</span><span class="comment">/* 32 less than */</span><span class="preprocessor"></span></div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ab79eab4dc371b1f96b74b13018caf525">  335</a></span>&#160;<span class="preprocessor"># define BN_SQR_RECURSIVE_SIZE_NORMAL            (16)</span><span class="comment">/* 32 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ae063a41b0d27b194c983af62702ddba8">  336</a></span>&#160;<span class="preprocessor"># define BN_MUL_LOW_RECURSIVE_SIZE_NORMAL        (32)</span><span class="comment">/* 32 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00337"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a686d08fc3b1212cad80d72bf12d22034">  337</a></span>&#160;<span class="preprocessor"># define BN_MONT_CTX_SET_SIZE_WORD               (64)</span><span class="comment">/* 32 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"> * 2011-02-22 SMS. In various places, a size_t variable or a type cast to</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"> * size_t was used to perform integer-only operations on pointers.  This</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> * failed on VMS with 64-bit pointers (CC /POINTER_SIZE = 64) because size_t</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> * is still only 32 bits.  What&#39;s needed in these cases is an integer type</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> * with the same size as a pointer, which size_t is not certain to be. The</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"> * only fix here is VMS-specific.</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="preprocessor"># if defined(OPENSSL_SYS_VMS)</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="preprocessor">#  if __INITIAL_POINTER_SIZE == 64</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="preprocessor">#   define PTR_SIZE_INT long long</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#  else                         </span><span class="comment">/* __INITIAL_POINTER_SIZE == 64 */</span><span class="preprocessor"></span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#   define PTR_SIZE_INT int</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="preprocessor">#  endif                        </span><span class="comment">/* __INITIAL_POINTER_SIZE == 64 [else] */</span><span class="preprocessor"></span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="preprocessor"># elif !defined(PTR_SIZE_INT)   </span><span class="comment">/* defined(OPENSSL_SYS_VMS) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ab7223cefc80c8dc142f31ccc363ff27f">  354</a></span>&#160;<span class="preprocessor">#  define PTR_SIZE_INT size_t</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="preprocessor"># endif                         </span><span class="comment">/* defined(OPENSSL_SYS_VMS) [else] */</span><span class="preprocessor"></span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="preprocessor"># if !defined(OPENSSL_NO_ASM) &amp;&amp; !defined(OPENSSL_NO_INLINE_ASM) &amp;&amp; !defined(PEDANTIC)</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> * BN_UMULT_HIGH section.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> * No, I&#39;m not trying to overwhelm you when stating that the</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> * product of N-bit numbers is 2*N bits wide:-) No, I don&#39;t expect</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> * you to be impressed when I say that if the compiler doesn&#39;t</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> * support 2*N integer type, then you have to replace every N*N</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> * multiplication with 4 (N/2)*(N/2) accompanied by some shifts</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> * and additions which unavoidably results in severe performance</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"> * penalties. Of course provided that the hardware is capable of</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"> * producing 2*N result... That&#39;s when you normally start</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"> * considering assembler implementation. However! It should be</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"> * pointed out that some CPUs (most notably Alpha, PowerPC and</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"> * upcoming IA-64 family:-) provide *separate* instruction</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"> * calculating the upper half of the product placing the result</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"> * into a general purpose register. Now *if* the compiler supports</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment"> * inline assembler, then it&#39;s not impossible to implement the</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"> * &quot;bignum&quot; routines (and have the compiler optimize &#39;em)</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"> * exhibiting &quot;native&quot; performance in C. That&#39;s what BN_UMULT_HIGH</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment"> * macro is about:-)</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"> *                                      &lt;appro@fy.chalmers.se&gt;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="preprocessor">#  if defined(__alpha) &amp;&amp; (defined(SIXTY_FOUR_BIT_LONG) || defined(SIXTY_FOUR_BIT))</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#   if defined(__DECC)</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="preprocessor">#    include &lt;c_asm.h&gt;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)   (BN_ULONG)asm(&quot;umulh %a0,%a1,%v0&quot;,(a),(b))</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#   elif defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)   ({      \</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">        register BN_ULONG ret;          \</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">        asm (&quot;umulh     %1,%2,%0&quot;       \</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">             : &quot;=r&quot;(ret)                \</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="preprocessor">             : &quot;r&quot;(a), &quot;r&quot;(b));         \</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">        ret;                    })</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="preprocessor">#   endif                       </span><span class="comment">/* compiler */</span><span class="preprocessor"></span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#  elif defined(_ARCH_PPC) &amp;&amp; defined(__64BIT__) &amp;&amp; defined(SIXTY_FOUR_BIT_LONG)</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="preprocessor">#   if defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)   ({      \</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">        register BN_ULONG ret;          \</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">        asm (&quot;mulhdu    %0,%1,%2&quot;       \</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="preprocessor">             : &quot;=r&quot;(ret)                \</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="preprocessor">             : &quot;r&quot;(a), &quot;r&quot;(b));         \</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">        ret;                    })</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="preprocessor">#   endif                       </span><span class="comment">/* compiler */</span><span class="preprocessor"></span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#  elif (defined(__x86_64) || defined(__x86_64__)) &amp;&amp; \</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="preprocessor">       (defined(SIXTY_FOUR_BIT_LONG) || defined(SIXTY_FOUR_BIT))</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">#   if defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)   ({      \</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">        register BN_ULONG ret,discard;  \</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">        asm (&quot;mulq      %3&quot;             \</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="preprocessor">             : &quot;=a&quot;(discard),&quot;=d&quot;(ret)  \</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">             : &quot;a&quot;(a), &quot;g&quot;(b)           \</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">             : &quot;cc&quot;);                   \</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="preprocessor">        ret;                    })</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#    define BN_UMULT_LOHI(low,high,a,b)  \</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="preprocessor">        asm (&quot;mulq      %3&quot;             \</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">                : &quot;=a&quot;(low),&quot;=d&quot;(high)  \</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">                : &quot;a&quot;(a),&quot;g&quot;(b)         \</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">                : &quot;cc&quot;);</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="preprocessor">#  elif (defined(_M_AMD64) || defined(_M_X64)) &amp;&amp; defined(SIXTY_FOUR_BIT)</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#   if defined(_MSC_VER) &amp;&amp; _MSC_VER&gt;=1400</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="keywordtype">unsigned</span> __int64 __umulh(<span class="keywordtype">unsigned</span> __int64 a, <span class="keywordtype">unsigned</span> __int64 b);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">unsigned</span> __int64 _umul128(<span class="keywordtype">unsigned</span> __int64 a, <span class="keywordtype">unsigned</span> __int64 b,</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                          <span class="keywordtype">unsigned</span> __int64 *<a class="code" href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a>);</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#    pragma intrinsic(__umulh,_umul128)</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)           __umulh((a),(b))</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">#    define BN_UMULT_LOHI(low,high,a,b)  ((low)=_umul128((a),(b),&amp;(high)))</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#  elif defined(__mips) &amp;&amp; (defined(SIXTY_FOUR_BIT) || defined(SIXTY_FOUR_BIT_LONG))</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="preprocessor">#   if defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#    if defined(__SIZEOF_INT128__) &amp;&amp; __SIZEOF_INT128__==16</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="comment">/* &quot;h&quot; constraint is not an option on R6 and was removed in 4.4 */</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="preprocessor">#     define BN_UMULT_HIGH(a,b)          (((__uint128_t)(a)*(b))&gt;&gt;64)</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#     define BN_UMULT_LOHI(low,high,a,b) ({     \</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="preprocessor">        __uint128_t ret=(__uint128_t)(a)*(b);   \</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">        (high)=ret&gt;&gt;64; (low)=ret;       })</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#    else</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#     define BN_UMULT_HIGH(a,b) ({      \</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">        register BN_ULONG ret;          \</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="preprocessor">        asm (&quot;dmultu    %1,%2&quot;          \</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">             : &quot;=h&quot;(ret)                \</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor">             : &quot;r&quot;(a), &quot;r&quot;(b) : &quot;l&quot;);   \</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">        ret;                    })</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="preprocessor">#     define BN_UMULT_LOHI(low,high,a,b)\</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">        asm (&quot;dmultu    %2,%3&quot;          \</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="preprocessor">             : &quot;=l&quot;(low),&quot;=h&quot;(high)     \</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="preprocessor">             : &quot;r&quot;(a), &quot;r&quot;(b));</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#    endif</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="preprocessor">#  elif defined(__aarch64__) &amp;&amp; defined(SIXTY_FOUR_BIT_LONG)</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#   if defined(__GNUC__) &amp;&amp; __GNUC__&gt;=2</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#    define BN_UMULT_HIGH(a,b)   ({      \</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">        register BN_ULONG ret;          \</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">        asm (&quot;umulh     %0,%1,%2&quot;       \</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="preprocessor">             : &quot;=r&quot;(ret)                \</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">             : &quot;r&quot;(a), &quot;r&quot;(b));         \</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="preprocessor">        ret;                    })</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor">#   endif</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="preprocessor">#  endif                        </span><span class="comment">/* cpu */</span><span class="preprocessor"></span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="preprocessor"># endif                         </span><span class="comment">/* OPENSSL_NO_ASM */</span><span class="preprocessor"></span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">/*************************************************************</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"> * Using the long long type</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aff16334b2f4699282cd66292e71aa7a3">  463</a></span>&#160;<span class="preprocessor"># define Lw(t)    (((BN_ULONG)(t))&amp;BN_MASK2)</span></div><div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a584eb52fa975ad3d763ce8aad9f603ab">  464</a></span>&#160;<span class="preprocessor"># define Hw(t)    (((BN_ULONG)((t)&gt;&gt;BN_BITS2))&amp;BN_MASK2)</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor"># ifdef BN_DEBUG_RAND</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="preprocessor">#  define bn_clear_top2max(a) \</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="preprocessor">        { \</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">        int      ind = (a)-&gt;dmax - (a)-&gt;top; \</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="preprocessor">        BN_ULONG *ftl = &amp;(a)-&gt;d[(a)-&gt;top-1]; \</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="preprocessor">        for (; ind != 0; ind--) \</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="preprocessor">                *(++ftl) = 0x0; \</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="preprocessor"># else</span></div><div class="line"><a name="l00475"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ae7cb64221e7b71010d738df76a104564">  475</a></span>&#160;<span class="preprocessor">#  define bn_clear_top2max(a)</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="preprocessor"># endif</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="preprocessor"># ifdef BN_LLONG</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="preprocessor">#  define mul_add(r,a,w,c) { \</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">        BN_ULLONG t; \</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">        t=(BN_ULLONG)w * (a) + (r) + (c); \</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="preprocessor">        (r)= Lw(t); \</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">        (c)= Hw(t); \</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#  define mul(r,a,w,c) { \</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="preprocessor">        BN_ULLONG t; \</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="preprocessor">        t=(BN_ULLONG)w * (a) + (c); \</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="preprocessor">        (r)= Lw(t); \</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="preprocessor">        (c)= Hw(t); \</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="preprocessor">#  define sqr(r0,r1,a) { \</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="preprocessor">        BN_ULLONG t; \</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="preprocessor">        t=(BN_ULLONG)(a)*(a); \</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="preprocessor">        (r0)=Lw(t); \</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="preprocessor">        (r1)=Hw(t); \</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="preprocessor"># elif defined(BN_UMULT_LOHI)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="preprocessor">#  define mul_add(r,a,w,c) {              \</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="preprocessor">        BN_ULONG high,low,ret,tmp=(a);  \</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="preprocessor">        ret =  (r);                     \</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="preprocessor">        BN_UMULT_LOHI(low,high,w,tmp);  \</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="preprocessor">        ret += (c);                     \</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">        (c) =  (ret&lt;(c))?1:0;           \</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">        (c) += high;                    \</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">        ret += low;                     \</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">        (c) += (ret&lt;low)?1:0;           \</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">        (r) =  ret;                     \</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#  define mul(r,a,w,c)    {               \</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">        BN_ULONG high,low,ret,ta=(a);   \</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="preprocessor">        BN_UMULT_LOHI(low,high,w,ta);   \</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="preprocessor">        ret =  low + (c);               \</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="preprocessor">        (c) =  high;                    \</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">        (c) += (ret&lt;low)?1:0;           \</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="preprocessor">        (r) =  ret;                     \</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="preprocessor">#  define sqr(r0,r1,a)    {               \</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="preprocessor">        BN_ULONG tmp=(a);               \</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">        BN_UMULT_LOHI(r0,r1,tmp,tmp);   \</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="preprocessor"># elif defined(BN_UMULT_HIGH)</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="preprocessor">#  define mul_add(r,a,w,c) {              \</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="preprocessor">        BN_ULONG high,low,ret,tmp=(a);  \</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="preprocessor">        ret =  (r);                     \</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">        high=  BN_UMULT_HIGH(w,tmp);    \</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="preprocessor">        ret += (c);                     \</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="preprocessor">        low =  (w) * tmp;               \</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="preprocessor">        (c) =  (ret&lt;(c))?1:0;           \</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">        (c) += high;                    \</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="preprocessor">        ret += low;                     \</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="preprocessor">        (c) += (ret&lt;low)?1:0;           \</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="preprocessor">        (r) =  ret;                     \</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="preprocessor">#  define mul(r,a,w,c)    {               \</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">        BN_ULONG high,low,ret,ta=(a);   \</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="preprocessor">        low =  (w) * ta;                \</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">        high=  BN_UMULT_HIGH(w,ta);     \</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">        ret =  low + (c);               \</span></div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">        (c) =  high;                    \</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="preprocessor">        (c) += (ret&lt;low)?1:0;           \</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="preprocessor">        (r) =  ret;                     \</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="preprocessor">#  define sqr(r0,r1,a)    {               \</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="preprocessor">        BN_ULONG tmp=(a);               \</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">        (r0) = tmp * tmp;               \</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="preprocessor">        (r1) = BN_UMULT_HIGH(tmp,tmp);  \</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="preprocessor"># else</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">/*************************************************************</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment"> * No long long type</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a35d0bfd412a01ad51bc61f20687087e1">  562</a></span>&#160;<span class="preprocessor">#  define LBITS(a)        ((a)&amp;BN_MASK2l)</span></div><div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#aa24b2c51cb24cd1d1b26e59d88ea8247">  563</a></span>&#160;<span class="preprocessor">#  define HBITS(a)        (((a)&gt;&gt;BN_BITS4)&amp;BN_MASK2l)</span></div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a2068e5a15a8241379ba562ef6f0c531f">  564</a></span>&#160;<span class="preprocessor">#  define L2HBITS(a)      (((a)&lt;&lt;BN_BITS4)&amp;BN_MASK2)</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a5defd7a79830b2e9424930e88b7430a5">  566</a></span>&#160;<span class="preprocessor">#  define LLBITS(a)       ((a)&amp;BN_MASKl)</span></div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#af7be055b02694112341c39dce1708603">  567</a></span>&#160;<span class="preprocessor">#  define LHBITS(a)       (((a)&gt;&gt;BN_BITS2)&amp;BN_MASKl)</span></div><div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#af5ee5bc19a28edfff45f1ddf0f9a8b2d">  568</a></span>&#160;<span class="preprocessor">#  define LL2HBITS(a)     ((BN_ULLONG)((a)&amp;BN_MASKl)&lt;&lt;BN_BITS2)</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ae964651fe6202c5885209c20f83f23d1">  570</a></span>&#160;<span class="preprocessor">#  define mul64(l,h,bl,bh) \</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="preprocessor">        { \</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="preprocessor">        BN_ULONG m,m1,lt,ht; \</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="preprocessor">        lt=l; \</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="preprocessor">        ht=h; \</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="preprocessor">        m =(bh)*(lt); \</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="preprocessor">        lt=(bl)*(lt); \</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="preprocessor">        m1=(bl)*(ht); \</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="preprocessor">        ht =(bh)*(ht); \</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="preprocessor">        m=(m+m1)&amp;BN_MASK2; if (m &lt; m1) ht+=L2HBITS((BN_ULONG)1); \</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="preprocessor">        ht+=HBITS(m); \</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="preprocessor">        m1=L2HBITS(m); \</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="preprocessor">        lt=(lt+m1)&amp;BN_MASK2; if (lt &lt; m1) ht++; \</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">        (l)=lt; \</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="preprocessor">        (h)=ht; \</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a901af4fc23aa068b1e320733c85733cb">  588</a></span>&#160;<span class="preprocessor">#  define sqr64(lo,ho,in) \</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">        { \</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="preprocessor">        BN_ULONG l,h,m; \</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="preprocessor">        h=(in); \</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="preprocessor">        l=LBITS(h); \</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="preprocessor">        h=HBITS(h); \</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="preprocessor">        m =(l)*(h); \</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="preprocessor">        l*=l; \</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="preprocessor">        h*=h; \</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="preprocessor">        h+=(m&amp;BN_MASK2h1)&gt;&gt;(BN_BITS4-1); \</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="preprocessor">        m =(m&amp;BN_MASK2l)&lt;&lt;(BN_BITS4+1); \</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="preprocessor">        l=(l+m)&amp;BN_MASK2; if (l &lt; m) h++; \</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="preprocessor">        (lo)=l; \</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="preprocessor">        (ho)=h; \</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#a05332f923637e3aff973b2a4cd637642">  605</a></span>&#160;<span class="preprocessor">#  define mul_add(r,a,bl,bh,c) { \</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="preprocessor">        BN_ULONG l,h; \</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">        h= (a); \</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="preprocessor">        l=LBITS(h); \</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="preprocessor">        h=HBITS(h); \</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">        mul64(l,h,(bl),(bh)); \</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">        </span><span class="comment">/* non-multiply part */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">        l=(l+(c))&amp;BN_MASK2; if (l &lt; (c)) h++; \</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="preprocessor">        (c)=(r); \</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="preprocessor">        l=(l+(c))&amp;BN_MASK2; if (l &lt; (c)) h++; \</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="preprocessor">        (c)=h&amp;BN_MASK2; \</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="preprocessor">        (r)=l; \</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="bn__lcl_8h.html#ae3ec5285ca2fb467d2a61f24299f7228">  621</a></span>&#160;<span class="preprocessor">#  define mul(r,a,bl,bh,c) { \</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="preprocessor">        BN_ULONG l,h; \</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="preprocessor">        h= (a); \</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="preprocessor">        l=LBITS(h); \</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">        h=HBITS(h); \</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">        mul64(l,h,(bl),(bh)); \</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="preprocessor"> \</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="preprocessor">        </span><span class="comment">/* non-multiply part */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">        l+=(c); if ((l&amp;BN_MASK2) &lt; (c)) h++; \</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="preprocessor">        (c)=h&amp;BN_MASK2; \</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="preprocessor">        (r)=l&amp;BN_MASK2; \</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="preprocessor">        }</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor"># endif                         </span><span class="comment">/* !BN_LLONG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#aac14d9be4ac98d2840f9b2e1e2f78653">BN_RECP_CTX_init</a>(BN_RECP_CTX *recp);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a372523413775537761de90c214860420">BN_MONT_CTX_init</a>(BN_MONT_CTX *<a class="code" href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#ae61bc4d64d5cab73beb144c215642a3e">bn_init</a>(BIGNUM *a);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#aae8e02ef5cfb645350a68e2257dfb6ef">bn_mul_normal</a>(BN_ULONG *r, BN_ULONG *a, <span class="keywordtype">int</span> na, BN_ULONG *b, <span class="keywordtype">int</span> nb);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a21798a458a8ba13d546476782e9af6cb">bn_mul_comba8</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a75c1f2d04e0962563059db6a54ce24bd">bn_mul_comba4</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a9db2fe9b42072ad54dabe3817d9eb542">bn_sqr_normal</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a, <span class="keywordtype">int</span> n, BN_ULONG *tmp);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#ab14b57d6cc26f5c01ff67b38aedfdb0d">bn_sqr_comba8</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#aad7853a13d5060b4d8b974aa1387f352">bn_sqr_comba4</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#a8dafaac057ccea141be417b228d862e2">bn_cmp_words</a>(<span class="keyword">const</span> BN_ULONG *a, <span class="keyword">const</span> BN_ULONG *b, <span class="keywordtype">int</span> n);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#ab5e7dcb0d066f21a51167d28eac0cc53">bn_cmp_part_words</a>(<span class="keyword">const</span> BN_ULONG *a, <span class="keyword">const</span> BN_ULONG *b, <span class="keywordtype">int</span> cl, <span class="keywordtype">int</span> dl);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a3d5f82c8bab37b71a56a6e7c5c649cd3">bn_mul_recursive</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, <span class="keywordtype">int</span> n2,</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                      <span class="keywordtype">int</span> dna, <span class="keywordtype">int</span> dnb, BN_ULONG *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a592088e87d0969178205f9653ce58d8b">bn_mul_part_recursive</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b,</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                           <span class="keywordtype">int</span> n, <span class="keywordtype">int</span> tna, <span class="keywordtype">int</span> tnb, BN_ULONG *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#ab92b4512c18f3a9b8825411a0e310693">bn_sqr_recursive</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a, <span class="keywordtype">int</span> n2, BN_ULONG *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a3a2b4cc93a313db5ecae737424ab18ba">bn_mul_low_normal</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, <span class="keywordtype">int</span> n);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a53755fa8fd973a929ea5a5302d301109">bn_mul_low_recursive</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, <span class="keywordtype">int</span> n2,</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                          BN_ULONG *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="keywordtype">void</span> <a class="code" href="bn__lcl_8h.html#a6e87ca1b4132e92a81ced0dd02ecef19">bn_mul_high</a>(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, BN_ULONG *l, <span class="keywordtype">int</span> n2,</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                 BN_ULONG *<a class="code" href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a>);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#ad068354719b14674977ada0dc46d009b">bn_add_part_words</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a, <span class="keyword">const</span> BN_ULONG *b,</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                           <span class="keywordtype">int</span> cl, <span class="keywordtype">int</span> dl);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;BN_ULONG <a class="code" href="bn__lcl_8h.html#a826ee43df04f317a4a8a33485de4ad01">bn_sub_part_words</a>(BN_ULONG *r, <span class="keyword">const</span> BN_ULONG *a, <span class="keyword">const</span> BN_ULONG *b,</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                           <span class="keywordtype">int</span> cl, <span class="keywordtype">int</span> dl);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#a8bb9c9bd48d8c0edf0c23558d6826554">bn_mul_mont</a>(BN_ULONG *rp, <span class="keyword">const</span> BN_ULONG *ap, <span class="keyword">const</span> BN_ULONG *<a class="code" href="openssl_2conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a>,</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="keyword">const</span> BN_ULONG *np, <span class="keyword">const</span> BN_ULONG *n0, <span class="keywordtype">int</span> num);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;BIGNUM *<a class="code" href="bn__lcl_8h.html#a4bfc00b7f157407d2bd7bf800a523102">int_bn_mod_inverse</a>(BIGNUM *<a class="code" href="dtlsv1listentest_8c.html#a8a7648e0e1b1b43f9c3fc3644391a582">in</a>,</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                           <span class="keyword">const</span> BIGNUM *a, <span class="keyword">const</span> BIGNUM *n, BN_CTX *<a class="code" href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a>,</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                           <span class="keywordtype">int</span> *noinv);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#a27b24d33ebc3e975254c72d91706d9a4">bn_probable_prime_dh</a>(BIGNUM *rnd, <span class="keywordtype">int</span> <a class="code" href="bn_8h.html#a61c4a1901536ab6b91b0b2c8b41a9a73">bits</a>,</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                         <span class="keyword">const</span> BIGNUM *<a class="code" href="bn_8h.html#a5923bba5dfb0907a9d8fa77ad3d762c1">add</a>, <span class="keyword">const</span> BIGNUM *<a class="code" href="bn_8h.html#ad4fd815455415c6f9a1ddc4431b81169">rem</a>, BN_CTX *<a class="code" href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a>);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#a3c350850ba67a58e6970b9b131f55d1f">bn_probable_prime_dh_retry</a>(BIGNUM *rnd, <span class="keywordtype">int</span> <a class="code" href="bn_8h.html#a61c4a1901536ab6b91b0b2c8b41a9a73">bits</a>, BN_CTX *<a class="code" href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="keywordtype">int</span> <a class="code" href="bn__lcl_8h.html#a35075221f29cc48a56440c7a1c23ada4">bn_probable_prime_dh_coprime</a>(BIGNUM *rnd, <span class="keywordtype">int</span> <a class="code" href="bn_8h.html#a61c4a1901536ab6b91b0b2c8b41a9a73">bits</a>, BN_CTX *<a class="code" href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="keyword">static</span> <a class="code" href="e__os2_8h.html#ac6a55c4922148048261f0e91f96474b3">ossl_inline</a> BIGNUM *bn_expand(BIGNUM *a, <span class="keywordtype">int</span> <a class="code" href="bn_8h.html#a61c4a1901536ab6b91b0b2c8b41a9a73">bits</a>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;{</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> (bits &gt; (INT_MAX - <a class="code" href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a> + 1))</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="e__des3_8c.html#ab709b098f24ad7cc05fc6eb2df218a27">NULL</a>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span> (((bits+<a class="code" href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a>-1)/<a class="code" href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a>) &lt;= (a)-&gt;<a class="code" href="structbignum__st.html#a3957bf07e2d7a09bae62601592079d3d">dmax</a>)</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">return</span> a;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="bntest_8c.html#a9e989c8d55becba58d702f60ae1ed800">bn_expand2</a>((a),(bits+<a class="code" href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a>-1)/<a class="code" href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;}</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="preprocessor">#ifdef  __cplusplus</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="preprocessor">#endif</span></div><div class="ttc" id="bn__lcl_8h_html_a4bfc00b7f157407d2bd7bf800a523102"><div class="ttname"><a href="bn__lcl_8h.html#a4bfc00b7f157407d2bd7bf800a523102">int_bn_mod_inverse</a></div><div class="ttdeci">BIGNUM * int_bn_mod_inverse(BIGNUM *in, const BIGNUM *a, const BIGNUM *n, BN_CTX *ctx, int *noinv)</div><div class="ttdef"><b>Definition:</b> <a href="bn__gcd_8c_source.html#l00135">bn_gcd.c:135</a></div></div>
<div class="ttc" id="bn_8h_html_a61c4a1901536ab6b91b0b2c8b41a9a73"><div class="ttname"><a href="bn_8h.html#a61c4a1901536ab6b91b0b2c8b41a9a73">bits</a></div><div class="ttdeci">int void(*) BN_CTX void *cb_arg in bits)</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00302">bn.h:302</a></div></div>
<div class="ttc" id="ec__curve_8c_html_a5138e082c1d42b393c076f8f796b3c96"><div class="ttname"><a href="ec__curve_8c.html#a5138e082c1d42b393c076f8f796b3c96">h</a></div><div class="ttdeci">EC_CURVE_DATA h</div><div class="ttdef"><b>Definition:</b> <a href="ec__curve_8c_source.html#l00040">ec_curve.c:40</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="structbn__mont__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">bn_mont_ctx_st::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00238">bn_lcl.h:238</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html_adefccf195553a86b78e30f79147bb619"><div class="ttname"><a href="structbn__mont__ctx__st.html#adefccf195553a86b78e30f79147bb619">bn_mont_ctx_st::ri</a></div><div class="ttdeci">int ri</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00230">bn_lcl.h:230</a></div></div>
<div class="ttc" id="bn_8h_html_a0ce569621a7e3dc19bd2dff0342f77a1"><div class="ttname"><a href="bn_8h.html#a0ce569621a7e3dc19bd2dff0342f77a1">BN_BITS2</a></div><div class="ttdeci">#define BN_BITS2</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00060">bn.h:60</a></div></div>
<div class="ttc" id="openssl_2conf_8h_html_a8f12a78fdc053e4143bc0896f8b3d937"><div class="ttname"><a href="openssl_2conf_8h.html#a8f12a78fdc053e4143bc0896f8b3d937">bp</a></div><div class="ttdeci">BIO * bp</div><div class="ttdef"><b>Definition:</b> <a href="openssl_2conf_8h_source.html#l00078">conf.h:78</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a53755fa8fd973a929ea5a5302d301109"><div class="ttname"><a href="bn__lcl_8h.html#a53755fa8fd973a929ea5a5302d301109">bn_mul_low_recursive</a></div><div class="ttdeci">void bn_mul_low_recursive(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, int n2, BN_ULONG *t)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00638">bn_mul.c:638</a></div></div>
<div class="ttc" id="bn_8h_html_a45f7c3206273aa418c568d977ea858d7"><div class="ttname"><a href="bn_8h.html#a45f7c3206273aa418c568d977ea858d7">ctx</a></div><div class="ttdeci">int void(*) BN_CTX ctx)</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00294">bn.h:294</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a826ee43df04f317a4a8a33485de4ad01"><div class="ttname"><a href="bn__lcl_8h.html#a826ee43df04f317a4a8a33485de4ad01">bn_sub_part_words</a></div><div class="ttdeci">BN_ULONG bn_sub_part_words(BN_ULONG *r, const BN_ULONG *a, const BN_ULONG *b, int cl, int dl)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00027">bn_mul.c:27</a></div></div>
<div class="ttc" id="asn1_8h_html_a3d54702d866c88bc4b3a88e68fb986d9"><div class="ttname"><a href="asn1_8h.html#a3d54702d866c88bc4b3a88e68fb986d9">t</a></div><div class="ttdeci">DIRECTORYSTRING time_t t</div><div class="ttdef"><b>Definition:</b> <a href="asn1_8h_source.html#l00624">asn1.h:624</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a3d5f82c8bab37b71a56a6e7c5c649cd3"><div class="ttname"><a href="bn__lcl_8h.html#a3d5f82c8bab37b71a56a6e7c5c649cd3">bn_mul_recursive</a></div><div class="ttdeci">void bn_mul_recursive(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, int n2, int dna, int dnb, BN_ULONG *t)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00333">bn_mul.c:333</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a8dafaac057ccea141be417b228d862e2"><div class="ttname"><a href="bn__lcl_8h.html#a8dafaac057ccea141be417b228d862e2">bn_cmp_words</a></div><div class="ttdeci">int bn_cmp_words(const BN_ULONG *a, const BN_ULONG *b, int n)</div><div class="ttdef"><b>Definition:</b> <a href="bn__lib_8c_source.html#l00776">bn_lib.c:776</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html"><div class="ttname"><a href="structbn__recp__ctx__st.html">bn_recp_ctx_st</a></div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00245">bn_lcl.h:245</a></div></div>
<div class="ttc" id="bn_8h_html_a5923bba5dfb0907a9d8fa77ad3d762c1"><div class="ttname"><a href="bn_8h.html#a5923bba5dfb0907a9d8fa77ad3d762c1">add</a></div><div class="ttdeci">int void(*) BN_CTX void *cb_arg int int const BIGNUM add)</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00302">bn.h:302</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a32efc91cebb4b69fc06e1b4188ce4a59"><div class="ttname"><a href="bn__lcl_8h.html#a32efc91cebb4b69fc06e1b4188ce4a59">bn_sub_words</a></div><div class="ttdeci">BN_ULONG bn_sub_words(BN_ULONG *rp, const BN_ULONG *ap, const BN_ULONG *bp, int num)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00371">bn_asm.c:371</a></div></div>
<div class="ttc" id="bn_8h_html_a3440f8540faaec9c34da16295933680d"><div class="ttname"><a href="bn_8h.html#a3440f8540faaec9c34da16295933680d">cb</a></div><div class="ttdeci">int void(*) BN_CTX void *cb_arg int int const BIGNUM const BIGNUM BN_GENCB cb)</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00302">bn.h:302</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html"><div class="ttname"><a href="structbn__mont__ctx__st.html">bn_mont_ctx_st</a></div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00229">bn_lcl.h:229</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_aae8e02ef5cfb645350a68e2257dfb6ef"><div class="ttname"><a href="bn__lcl_8h.html#aae8e02ef5cfb645350a68e2257dfb6ef">bn_mul_normal</a></div><div class="ttdeci">void bn_mul_normal(BN_ULONG *r, BN_ULONG *a, int na, BN_ULONG *b, int nb)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00983">bn_mul.c:983</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a3c350850ba67a58e6970b9b131f55d1f"><div class="ttname"><a href="bn__lcl_8h.html#a3c350850ba67a58e6970b9b131f55d1f">bn_probable_prime_dh_retry</a></div><div class="ttdeci">int bn_probable_prime_dh_retry(BIGNUM *rnd, int bits, BN_CTX *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="bn__prime_8c_source.html#l00308">bn_prime.c:308</a></div></div>
<div class="ttc" id="structbignum__st_html"><div class="ttname"><a href="structbignum__st.html">bignum_st</a></div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00218">bn_lcl.h:218</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a21798a458a8ba13d546476782e9af6cb"><div class="ttname"><a href="bn__lcl_8h.html#a21798a458a8ba13d546476782e9af6cb">bn_mul_comba8</a></div><div class="ttdeci">void bn_mul_comba8(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00581">bn_asm.c:581</a></div></div>
<div class="ttc" id="structbignum__st_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="structbignum__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">bignum_st::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00225">bn_lcl.h:225</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a6e87ca1b4132e92a81ced0dd02ecef19"><div class="ttname"><a href="bn__lcl_8h.html#a6e87ca1b4132e92a81ced0dd02ecef19">bn_mul_high</a></div><div class="ttdeci">void bn_mul_high(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, BN_ULONG *l, int n2, BN_ULONG *t)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00663">bn_mul.c:663</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a35075221f29cc48a56440c7a1c23ada4"><div class="ttname"><a href="bn__lcl_8h.html#a35075221f29cc48a56440c7a1c23ada4">bn_probable_prime_dh_coprime</a></div><div class="ttdeci">int bn_probable_prime_dh_coprime(BIGNUM *rnd, int bits, BN_CTX *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="bn__prime_8c_source.html#l00335">bn_prime.c:335</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ab14b57d6cc26f5c01ff67b38aedfdb0d"><div class="ttname"><a href="bn__lcl_8h.html#ab14b57d6cc26f5c01ff67b38aedfdb0d">bn_sqr_comba8</a></div><div class="ttdeci">void bn_sqr_comba8(BN_ULONG *r, const BN_ULONG *a)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00723">bn_asm.c:723</a></div></div>
<div class="ttc" id="structbignum__st_html_a186b6342d483ea691785eb9a6d88605b"><div class="ttname"><a href="structbignum__st.html#a186b6342d483ea691785eb9a6d88605b">bignum_st::neg</a></div><div class="ttdeci">int neg</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00224">bn_lcl.h:224</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a27b24d33ebc3e975254c72d91706d9a4"><div class="ttname"><a href="bn__lcl_8h.html#a27b24d33ebc3e975254c72d91706d9a4">bn_probable_prime_dh</a></div><div class="ttdeci">int bn_probable_prime_dh(BIGNUM *rnd, int bits, const BIGNUM *add, const BIGNUM *rem, BN_CTX *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="bn__prime_8c_source.html#l00494">bn_prime.c:494</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ad068354719b14674977ada0dc46d009b"><div class="ttname"><a href="bn__lcl_8h.html#ad068354719b14674977ada0dc46d009b">bn_add_part_words</a></div><div class="ttdeci">BN_ULONG bn_add_part_words(BN_ULONG *r, const BN_ULONG *a, const BN_ULONG *b, int cl, int dl)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00155">bn_mul.c:155</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a8bb9c9bd48d8c0edf0c23558d6826554"><div class="ttname"><a href="bn__lcl_8h.html#a8bb9c9bd48d8c0edf0c23558d6826554">bn_mul_mont</a></div><div class="ttdeci">int bn_mul_mont(BN_ULONG *rp, const BN_ULONG *ap, const BN_ULONG *bp, const BN_ULONG *np, const BN_ULONG *n0, int num)</div><div class="ttdef"><b>Definition:</b> <a href="sparcv9cap_8c_source.html#l00026">sparcv9cap.c:26</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ab53b589b38d0dba70e7af60e433a674d"><div class="ttname"><a href="bn__lcl_8h.html#ab53b589b38d0dba70e7af60e433a674d">bn_mul_words</a></div><div class="ttdeci">BN_ULONG bn_mul_words(BN_ULONG *rp, const BN_ULONG *ap, int num, BN_ULONG w)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00136">bn_asm.c:136</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html_aa48ed99405e961fd992d716f0cd966cf"><div class="ttname"><a href="structbn__recp__ctx__st.html#aa48ed99405e961fd992d716f0cd966cf">bn_recp_ctx_st::Nr</a></div><div class="ttdeci">BIGNUM Nr</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00247">bn_lcl.h:247</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a8da498661b663764efd236e8973c5007"><div class="ttname"><a href="bn__lcl_8h.html#a8da498661b663764efd236e8973c5007">bn_add_words</a></div><div class="ttdeci">BN_ULONG bn_add_words(BN_ULONG *rp, const BN_ULONG *ap, const BN_ULONG *bp, int num)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00313">bn_asm.c:313</a></div></div>
<div class="ttc" id="bn__int_8h_html"><div class="ttname"><a href="bn__int_8h.html">bn_int.h</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a9db2fe9b42072ad54dabe3817d9eb542"><div class="ttname"><a href="bn__lcl_8h.html#a9db2fe9b42072ad54dabe3817d9eb542">bn_sqr_normal</a></div><div class="ttdeci">void bn_sqr_normal(BN_ULONG *r, const BN_ULONG *a, int n, BN_ULONG *tmp)</div><div class="ttdef"><b>Definition:</b> <a href="bn__sqr_8c_source.html#l00105">bn_sqr.c:105</a></div></div>
<div class="ttc" id="structbignum__st_html_a4422fb07afc9fd462635e42d26051c49"><div class="ttname"><a href="structbignum__st.html#a4422fb07afc9fd462635e42d26051c49">bignum_st::d</a></div><div class="ttdeci">BN_ULONG * d</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00219">bn_lcl.h:219</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html_a3248b66d0aee4e118d186124a596f522"><div class="ttname"><a href="structbn__recp__ctx__st.html#a3248b66d0aee4e118d186124a596f522">bn_recp_ctx_st::num_bits</a></div><div class="ttdeci">int num_bits</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00248">bn_lcl.h:248</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ab92b4512c18f3a9b8825411a0e310693"><div class="ttname"><a href="bn__lcl_8h.html#ab92b4512c18f3a9b8825411a0e310693">bn_sqr_recursive</a></div><div class="ttdeci">void bn_sqr_recursive(BN_ULONG *r, const BN_ULONG *a, int n2, BN_ULONG *t)</div><div class="ttdef"><b>Definition:</b> <a href="bn__sqr_8c_source.html#l00152">bn_sqr.c:152</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a3a2b4cc93a313db5ecae737424ab18ba"><div class="ttname"><a href="bn__lcl_8h.html#a3a2b4cc93a313db5ecae737424ab18ba">bn_mul_low_normal</a></div><div class="ttdeci">void bn_mul_low_normal(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, int n)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l01025">bn_mul.c:1025</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_aad7853a13d5060b4d8b974aa1387f352"><div class="ttname"><a href="bn__lcl_8h.html#aad7853a13d5060b4d8b974aa1387f352">bn_sqr_comba4</a></div><div class="ttdeci">void bn_sqr_comba4(BN_ULONG *r, const BN_ULONG *a)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00798">bn_asm.c:798</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a11b748f408b37078e940634d00c0acdf"><div class="ttname"><a href="bn__lcl_8h.html#a11b748f408b37078e940634d00c0acdf">bn_div_words</a></div><div class="ttdeci">BN_ULONG bn_div_words(BN_ULONG h, BN_ULONG l, BN_ULONG d)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00207">bn_asm.c:207</a></div></div>
<div class="ttc" id="structbignum__st_html_af93f4f37fc2ad9c37af4a715423b110c"><div class="ttname"><a href="structbignum__st.html#af93f4f37fc2ad9c37af4a715423b110c">bignum_st::top</a></div><div class="ttdeci">int top</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00221">bn_lcl.h:221</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a5099f504342e8405343b2f34a7e2042b"><div class="ttname"><a href="bn__lcl_8h.html#a5099f504342e8405343b2f34a7e2042b">bn_sqr_words</a></div><div class="ttdeci">void bn_sqr_words(BN_ULONG *rp, const BN_ULONG *ap, int num)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00168">bn_asm.c:168</a></div></div>
<div class="ttc" id="dtlsv1listentest_8c_html_a8a7648e0e1b1b43f9c3fc3644391a582"><div class="ttname"><a href="dtlsv1listentest_8c.html#a8a7648e0e1b1b43f9c3fc3644391a582">in</a></div><div class="ttdeci">const unsigned char * in</div><div class="ttdef"><b>Definition:</b> <a href="dtlsv1listentest_8c_source.html#l00240">dtlsv1listentest.c:240</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a75c1f2d04e0962563059db6a54ce24bd"><div class="ttname"><a href="bn__lcl_8h.html#a75c1f2d04e0962563059db6a54ce24bd">bn_mul_comba4</a></div><div class="ttdeci">void bn_mul_comba4(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00684">bn_asm.c:684</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html_ad0a9b4b193ae5312d7260bedd97090b9"><div class="ttname"><a href="structbn__mont__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">bn_mont_ctx_st::N</a></div><div class="ttdeci">BIGNUM N</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00232">bn_lcl.h:232</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html_ad0a9b4b193ae5312d7260bedd97090b9"><div class="ttname"><a href="structbn__recp__ctx__st.html#ad0a9b4b193ae5312d7260bedd97090b9">bn_recp_ctx_st::N</a></div><div class="ttdeci">BIGNUM N</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00246">bn_lcl.h:246</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_aac14d9be4ac98d2840f9b2e1e2f78653"><div class="ttname"><a href="bn__lcl_8h.html#aac14d9be4ac98d2840f9b2e1e2f78653">BN_RECP_CTX_init</a></div><div class="ttdeci">void BN_RECP_CTX_init(BN_RECP_CTX *recp)</div><div class="ttdef"><b>Definition:</b> <a href="bn__recp_8c_source.html#l00013">bn_recp.c:13</a></div></div>
<div class="ttc" id="structbn__gencb__st_html_a9ce2ec4812a92cb6ab39f6e81e9173a9"><div class="ttname"><a href="structbn__gencb__st.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">bn_gencb_st::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00256">bn_lcl.h:256</a></div></div>
<div class="ttc" id="bn_8h_html_ad4fd815455415c6f9a1ddc4431b81169"><div class="ttname"><a href="bn_8h.html#ad4fd815455415c6f9a1ddc4431b81169">rem</a></div><div class="ttdeci">int void(*) BN_CTX void *cb_arg int int const BIGNUM const BIGNUM rem)</div><div class="ttdef"><b>Definition:</b> <a href="bn_8h_source.html#l00302">bn.h:302</a></div></div>
<div class="ttc" id="structbn__gencb__st_html"><div class="ttname"><a href="structbn__gencb__st.html">bn_gencb_st</a></div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00254">bn_lcl.h:254</a></div></div>
<div class="ttc" id="bntest_8c_html_a9e989c8d55becba58d702f60ae1ed800"><div class="ttname"><a href="bntest_8c.html#a9e989c8d55becba58d702f60ae1ed800">bn_expand2</a></div><div class="ttdeci">#define bn_expand2</div><div class="ttdef"><b>Definition:</b> <a href="bntest_8c_source.html#l00034">bntest.c:34</a></div></div>
<div class="ttc" id="e__des3_8c_html_ab709b098f24ad7cc05fc6eb2df218a27"><div class="ttname"><a href="e__des3_8c.html#ab709b098f24ad7cc05fc6eb2df218a27">NULL</a></div><div class="ttdeci">EVP_CIPH_RAND_KEY NULL</div><div class="ttdef"><b>Definition:</b> <a href="e__des3_8c_source.html#l00213">e_des3.c:213</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a372523413775537761de90c214860420"><div class="ttname"><a href="bn__lcl_8h.html#a372523413775537761de90c214860420">BN_MONT_CTX_init</a></div><div class="ttdeci">void BN_MONT_CTX_init(BN_MONT_CTX *ctx)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mont_8c_source.html#l00225">bn_mont.c:225</a></div></div>
<div class="ttc" id="structbignum__st_html_a3957bf07e2d7a09bae62601592079d3d"><div class="ttname"><a href="structbignum__st.html#a3957bf07e2d7a09bae62601592079d3d">bignum_st::dmax</a></div><div class="ttdeci">int dmax</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00223">bn_lcl.h:223</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html_ac8bf36fe0577cba66bccda3a6f7e80a4"><div class="ttname"><a href="structbn__recp__ctx__st.html#ac8bf36fe0577cba66bccda3a6f7e80a4">bn_recp_ctx_st::flags</a></div><div class="ttdeci">int flags</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00250">bn_lcl.h:250</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html_a40f495d7fe7da52b68a829c6de297bc8"><div class="ttname"><a href="structbn__mont__ctx__st.html#a40f495d7fe7da52b68a829c6de297bc8">bn_mont_ctx_st::Ni</a></div><div class="ttdeci">BIGNUM Ni</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00233">bn_lcl.h:233</a></div></div>
<div class="ttc" id="structbn__mont__ctx__st_html_ad99ae4970cb39992572fc82ab7990fde"><div class="ttname"><a href="structbn__mont__ctx__st.html#ad99ae4970cb39992572fc82ab7990fde">bn_mont_ctx_st::RR</a></div><div class="ttdeci">BIGNUM RR</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00231">bn_lcl.h:231</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_a592088e87d0969178205f9653ce58d8b"><div class="ttname"><a href="bn__lcl_8h.html#a592088e87d0969178205f9653ce58d8b">bn_mul_part_recursive</a></div><div class="ttdeci">void bn_mul_part_recursive(BN_ULONG *r, BN_ULONG *a, BN_ULONG *b, int n, int tna, int tnb, BN_ULONG *t)</div><div class="ttdef"><b>Definition:</b> <a href="bn__mul_8c_source.html#l00480">bn_mul.c:480</a></div></div>
<div class="ttc" id="rand__lib_8c_html_a66d27b98b0edadbed6594350d5c023e4"><div class="ttname"><a href="rand__lib_8c.html#a66d27b98b0edadbed6594350d5c023e4">RAND_bytes</a></div><div class="ttdeci">int RAND_bytes(unsigned char *buf, int num)</div><div class="ttdef"><b>Definition:</b> <a href="rand__lib_8c_source.html#l00102">rand_lib.c:102</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ac7390b2c1f95cf296aaa80068bbea55c"><div class="ttname"><a href="bn__lcl_8h.html#ac7390b2c1f95cf296aaa80068bbea55c">bn_mul_add_words</a></div><div class="ttdeci">BN_ULONG bn_mul_add_words(BN_ULONG *rp, const BN_ULONG *ap, int num, BN_ULONG w)</div><div class="ttdef"><b>Definition:</b> <a href="bn__asm_8c_source.html#l00103">bn_asm.c:103</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ae61bc4d64d5cab73beb144c215642a3e"><div class="ttname"><a href="bn__lcl_8h.html#ae61bc4d64d5cab73beb144c215642a3e">bn_init</a></div><div class="ttdeci">void bn_init(BIGNUM *a)</div><div class="ttdef"><b>Definition:</b> <a href="bn__lib_8c_source.html#l00215">bn_lib.c:215</a></div></div>
<div class="ttc" id="structbn__gencb__st_html_aee119b00fe81f0baf8518dae456c9dc9"><div class="ttname"><a href="structbn__gencb__st.html#aee119b00fe81f0baf8518dae456c9dc9">bn_gencb_st::ver</a></div><div class="ttdeci">unsigned int ver</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00255">bn_lcl.h:255</a></div></div>
<div class="ttc" id="bn__lcl_8h_html_ab5e7dcb0d066f21a51167d28eac0cc53"><div class="ttname"><a href="bn__lcl_8h.html#ab5e7dcb0d066f21a51167d28eac0cc53">bn_cmp_part_words</a></div><div class="ttdeci">int bn_cmp_part_words(const BN_ULONG *a, const BN_ULONG *b, int cl, int dl)</div><div class="ttdef"><b>Definition:</b> <a href="bn__lib_8c_source.html#l00803">bn_lib.c:803</a></div></div>
<div class="ttc" id="structbn__recp__ctx__st_html_afd8d704fff636cf0234e92c1eade927c"><div class="ttname"><a href="structbn__recp__ctx__st.html#afd8d704fff636cf0234e92c1eade927c">bn_recp_ctx_st::shift</a></div><div class="ttdeci">int shift</div><div class="ttdef"><b>Definition:</b> <a href="bn__lcl_8h_source.html#l00249">bn_lcl.h:249</a></div></div>
<div class="ttc" id="e__os2_8h_html_ac6a55c4922148048261f0e91f96474b3"><div class="ttname"><a href="e__os2_8h.html#ac6a55c4922148048261f0e91f96474b3">ossl_inline</a></div><div class="ttdeci">#define ossl_inline</div><div class="ttdef"><b>Definition:</b> <a href="e__os2_8h_source.html#l00305">e_os2.h:305</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_53403d93963d3f5d2fcffd0698f5bddb.html">crypto</a></li><li class="navelem"><a class="el" href="dir_bf4984ea57f5888de95a64cb80bbf1fb.html">bn</a></li><li class="navelem"><a class="el" href="bn__lcl_8h.html">bn_lcl.h</a></li>
    <li class="footer">Generated on Fri Feb 17 2017 23:57:13 by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
